{% extends 'base.html' %}
{% block title %}Мои действия{% endblock %}

{% block content %}
<h2>Мои действия</h2>

<h3>Добавить новое действие</h3>
<form id="create-action-form" data-ajax="1">
  <input type="text" id="new-action-text" name="text" placeholder="Введите текст действия" required />
  <button type="submit">Создать</button>
</form>

<h3>Черновики</h3>
<div id="drafts-list">
  {% if drafts and drafts.length %}
    {% for d in drafts %}
      <div class="action-item" data-id="{{ d.id }}">
        <a href="/api/actions/action_card/{{ d.id }}">{{ d.text }}</a>
        <button type="button" class="delete-btn">Удалить</button>
        <select class="duration">
          <option value="10">10 мин</option>
          <option value="30">30 мин</option>
          <option value="60">1 час</option>
        </select>
        <button type="button" class="publish-btn">Опубликовать</button>
      </div>
    {% endfor %}
  {% else %}
    <p id="no-drafts">Нет черновиков</p>
  {% endif %}
</div>

<h3>Опубликованные действия</h3>
<div id="published-list">
  {% if published and published.length %}
    {% for a in published %}
      <div class="action-item" data-id="{{ a.id }}">
        <a href="/api/actions/action_card/{{ a.id }}">{{ a.text }}</a>
        <small>Действует до: {{ a.expiresAt or '—' }}</small>
        <button type="button" class="delete-btn">Удалить</button>
      </div>
    {% endfor %}
  {% else %}
    <p id="no-published">Нет опубликованных действий</p>
  {% endif %}
</div>

<script src="/static/js/my_actions.js"></script>
{% endblock %}
